#!/usr/bin/env python
# coding: utf-8

# In[4]:


"""
Описание задания: Вы получили данные о ежедневных продажах
небольшого магазина за месяц (30 дней). Ваша задача —
проанализировать эти данные, рассчитать основные статистические
показатели (среднее, медиана, стандартное отклонение) и
визуализировать результаты с помощью графиков (гистограмма,
линейный график, коробчатая диаграмма).
Задачи для выполнения:
3. Напишите краткий вывод о том, что вы узнали из анализа данных
(например, есть ли дни с аномально высокими или низкими
продажами, каков общий тренд).
4. (Дополнительно) Попробуйте добавить свои улучшения в код,
например, изменить цвета графиков или добавить подписи.
Требования:
• Используйте библиотеки numpy для расчетов и matplotlib для
визуализации.
• Код должен быть прокомментирован для понимания каждого шага.
• Сохраните графики в файл (например, в формате PNG).
Запустите код и изучите результаты (статистические показатели и
графики).
5. Напишите свои выводы в комментариях к коду или в отдельном
текстовом файле.
6. Попробуйте изменить код, например, добавить другие цвета для
графиков или дополнительные метки.
Критерии оценки (для самооценки):
• Код работает без ошибок (2 балла).
• Рассчитаны все требуемые статистические показатели (2 балла).
• Построены все три графика с подписями и легендами (3 балла).
• Написан вывод на основе анализа данных (2 балла).
• Добавлены свои улучшения в код (1 балл).
"""
# Импортируем необходимые библиотеки
import numpy as np
import matplotlib.pyplot as plt
# Данные о продажах за 30 дней
sales = [120, 150, 130, 170, 200, 180, 160, 140, 190, 210,
 220, 200, 180, 160, 150, 140, 130, 170, 190, 200,
 210, 230, 240, 220, 200, 180, 160, 150, 140, 130]
# 1. Расчет статистических показателей
mean_sales = np.mean(sales) # Среднее значение
median_sales = np.median(sales) # Медиана
std_sales = np.std(sales, ddof=1) # Стандартное отклонение (выборочное)
# Вывод результатов
print("Статистические показатели продаж:")
print(f"Среднее значение: {mean_sales:.2f}")
print(f"Медиана: {median_sales:.2f}")
print(f"Стандартное отклонение: {std_sales:.2f}")
# 2. Построение графиков
# Настройка общего размера фигуры для нескольких графиков
plt.figure(figsize=(15, 10))#график в сетке 15x10
# 2.1 Гистограмма распределения продаж
plt.subplot(3, 1, 1) # Первый график в сетке 3x1
plt.hist(sales, bins=10, color='mediumaquamarine', edgecolor='darkslategrey')# изменены цвета
plt.title('Гистограмма распределения продаж')#название графика
plt.xlabel('Продажи (у.е.)')#название горизонтальной оси 
plt.ylabel('Частота')#название вертикальной оси
plt.axvline(mean_sales, color='gold', linestyle='dashed', label=f'Среднее: {mean_sales:.2f}')# изменены цвета
plt.axvline(median_sales, color='salmon', linestyle='dashed', label=f'Медиана:{median_sales:.2f}')# изменены цвета
plt.legend()#Легенда описывает, что означают линии, маркеры или другие элементы графика, и позволяет различать серии данных. 
# 2.2 Линейный график изменения продаж по дням
plt.subplot(3, 1, 2) # Второй график в сетке 3x1
plt.plot(range(1, 31), sales, marker='o', color='rebeccapurple') # изменены цвета
plt.title('Изменение продаж по дням')#название графика
plt.xlabel('День')#название горизонтальной оси 
plt.ylabel('Продажи (у.е.)') #название вертикальной оси
plt.grid(True) #стандартная линия сетки графика
# 2.3 Коробчатая диаграмма для выявления выбросов
plt.subplot(3, 1, 3) # Третий график в сетке 3x1
plt.boxplot(sales, vert=True, patch_artist=True, boxprops=dict(facecolor='bisque'))# изменены цвета
plt.title('Коробчатая диаграмма продаж')#название графика
plt.ylabel('Продажи (у.е.)')#название вертикальной оси
plt.tight_layout()# Настройка компоновки графиков, чтобы они не перекрывались
#Функция для поиска пиков и падений продаж
price_changes = []
for i in range(1, len(sales)):
    change = sales[i] - sales[i-1]
    price_changes.append((i+1, sales[i], change))  # (день, продажи, изменение)

# Сортируем по изменению (price_change)
price_changes_sorted = sorted(price_changes, key=lambda x: x[2], reverse=True)

# 5 пиков роста продаж (максимальные изменения)
top_5_positive = price_changes_sorted[:5]

# 5 пиков падения продаж (минимальные изменения)
top_5_negative = sorted(price_changes, key=lambda x: x[2])[:5]

print("\n5 пиков роста продаж:")
for day, sales_val, change in top_5_positive:
    print(f"День {day}: Продажи = {sales_val}, Изменение = {change}")

print("\n5 пиков падения продаж:")
for day, sales_val, change in top_5_negative:
    print(f"День {day}: Продажи = {sales_val}, Изменение = {change}")
# 3. Место для вашего вывода (добавьте свои наблюдения)
# Например: "Средние продажи составляют около 180 у.е. в день. Наблюдаются пики продаж в середине месяца..."
print("""Из исследования, проведённоем на 31-одневном месяце (январь, март, май, июль, август, октябрь, декабрь) выявлены пики продаж второго,
четвёртого, пятого, девятого и восемнадцатого дня. При этом минимальные значения падения продаж после достижения пиков на второй, девятый 
и восемнадцатый дни совпадают и соответственно замедляются на двадцать седьмой день. Из чего можно заключить, что во-первых, пики продаж не приходятся
на один и тот же день недели, во-вторых, они дают толчок продажам в последующие дни, достигая пика пятого, одиннадцатого, и двадцать третьего дня, 
в-третьих, скорость падения продаж тем ниже, чем больший пик достигнут, в-четвёртых из-за него же ожидаемый пик спустя пять дней незаметен, так как по
сравнению с предыдущим представляется тенденция к падению продаж, как и на 14 день.
В основном, сумма продаж падают на 20, за исключением дней ожидаемых пиков, когда при условии, что не происходит пик, продажи падают на 10 вместо 20.
Средние продажи составляют около 175 у.е. в день с отклонением 33.3 у.е..""")
print("Комментарий к четвёртому заданию: цвета изменены, добавлена конструкция сохранения графиков в файл по желанию пользователя, а также")
print("функции для поиска пика и падения продаж.")
# Сохранение графиков в файл по желанию пользователя
save_fig = input("Сохранить графики в файл? (да/нет): ").strip().lower()#запрос ввода у пользователя с удалением пробелов и упорядочиванием регистра
if save_fig in ['да', 'д', 'yes', 'y', 'давай', 'go']:#варианты ответа
    plt.savefig('sales_analysis.png')
    print("Графики сохранены в файл 'sales_analysis.png'")
else:
    print("Графики не были сохранены.")
plt.show()# Отображение графиков после сохранения, потому что иначе не работает


# In[ ]:




